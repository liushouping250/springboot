package com.example.demo.rabbitmq.service;import com.rabbitmq.client.Channel;import org.springframework.amqp.core.Message;import org.springframework.amqp.rabbit.annotation.RabbitListener;import org.springframework.stereotype.Component;import java.io.IOException;/** * @description: 扇形交换机监听 * @author: Mr.monster.liu * @create: 2021-06-07 16:20 **/@Componentpublic class FanoutReceiver {    @RabbitListener(queues = "fanout.queue.a")    public void topicExchangeQueueA(Message testMessage, Channel channel) throws IOException {        System.out.println("fanout.queue.a消费者收到消息  : " + testMessage.toString());        channel.basicAck(testMessage.getMessageProperties().getDeliveryTag(), true);    }    @RabbitListener(queues = "fanout.queue.b")    public void topicExchangeQueueB(Message testMessage, Channel channel) throws IOException {        System.out.println("fanout.queue.b消费者收到消息  : " + testMessage.toString());        channel.basicAck(testMessage.getMessageProperties().getDeliveryTag(), true);    }    @RabbitListener(queues = "fanout.queue.c")    public void topicExchangeQueueC(Message testMessage, Channel channel) throws IOException {        System.out.println("fanout.queue.c消费者收到消息  : " + testMessage.toString());        // channel.basicNack(testMessage.getMessageProperties().getDeliveryTag(),false,true);        channel.basicAck(testMessage.getMessageProperties().getDeliveryTag(), true);        //rabbitTemplate.convertAndSend(RabbitMqEnum.FanoutExchange.getName(),"fanout.queue.c",testMessage);    }}